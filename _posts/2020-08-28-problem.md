---
title: 奇怪的题目增加了！
author: P-Henning
modify_date: 2020-09-20
permalink: /problem
key: problem
tags: [数学, 物理]
---

## 题目1

求任意相邻两位不全是$k$的$n$位$m$进制正整数的个数。

设任意相邻两位不全是$k$的$n$位$m$进制正整数有$a_n$个。

考虑在$n-1$位数里加入一个数字$x$，变成$n$位数。为了避免讨论最高位是否为$0$，这里将$x$放在$n-1$位数的最右边，成为$n$位数的个位。则$x$有$m$种取值。

<!--more-->

- 当$x\neq k$时，每一个满足条件的$n-1$位数对应一个个位是$x$的$n$位数。此时$x$有$m-1$种取值，贡献为$(m-1)a_{n-1}$。
- 当$x=k$时，需要$n-1$位数的个位不能是$k$。由上一种情况可知，个位不为$k$的$n$位数的个数为$(m-1)a_{n-1}$，于是个位不为$k$的$n-1$位数的个数为$(m-1)a_{n-2}$。每一个这样的$n-1$位数对应一个个位是$k$的$n$位数。贡献为$(m-1)a_{n-2}$。

于是得到递推式：

$$a_n=(m-1)a_{n-1}+(m-1)a_{n-2}$$

$\lbrace a_n\rbrace$的初始值需要分情况讨论：

- 当$k=0$时，有$a_1=m-1,a_2=m^2-m$。解得

  $$a_n=\dfrac{m-1+\sqrt{m^2+2m-3}}{2\sqrt{m^2+2m-3}}\left(\dfrac{m-1+\sqrt{m^2+2m-3}}2\right)^n-\dfrac{m-1-\sqrt{m^2+2m-3}}{2\sqrt{m^2+2m-3}}\left(\dfrac{m-1-\sqrt{m^2+2m-3}}2\right)^n$$
- 当$k\neq 0$时，有$a_1=m-1,a_2=m^2-m-1$。解得

  $$a_n=\dfrac{m^2-m+(m-2)\sqrt{m^2+2m-3}}{2(m-1)\sqrt{m^2+2m-3}}\left(\dfrac{m-1+\sqrt{m^2+2m-3}}2\right)^n-\dfrac{m^2-m-(m-2)\sqrt{m^2+2m-3}}{2(m-1)\sqrt{m^2+2m-3}}\left(\dfrac{m-1-\sqrt{m^2+2m-3}}2\right)^n$$

特别地，若$\lbrace F_n\rbrace$为斐波那契数列，当$m=2$时有

$$a_n=\begin{cases}
F_{n+1}&k=0\\
F_n&k\neq 0
\end{cases}$$

---

## 题目2

$k$维空间中有$n$个点，第$i$个点$P_i$的坐标为$(x_{i1},x_{i2},x_{i3},\dots,x_{ik})$。对所有可能的$j$，$x_{1j},x_{2j},x_{3j},\dots,x_{nj}$都是$1$到$n$的排列。求满足以下条件的点对$(P_a,P_b)$的个数的期望：对所有可能的$j$，有$x_{aj}<x_{bj}$。

由于不同维度的坐标之间相互独立，只需对所有可能的$j$将$x_{1j},x_{2j},x_{3j},\dots,x_{nj}$进行排列，就可以得到$n$个点的不同坐标。所以共有$N=(A_n^n)^k$种情况。

考虑一个$N$行$A_n^2$列的矩阵$M$，每一行对应一种情况，每一列对应一个点对$(P_a,P_b)$。若第$r$种情况下第$c$对点满足条件，则$M_{r,c}=1$，否则$M_{r,c}=0$。于是第$r$行的各项之和$\sum\limits_{c=1}^{A_n^2}M_{r,c}$就表示第$r$种情况下满足条件的点对数。

根据期望的定义，有

$$E=\sum_{r=1}^N\left(\dfrac 1N\sum_{c=1}^{A_n^2}M_{r,c}\right)$$

而上式可以改写成

$$E=\dfrac 1N\sum_{c=1}^{A_n^2}\left(\sum_{r=1}^N M_{r,c}\right)$$

其中矩阵$M$第$c$列的各项之和$\sum\limits_{r=1}^N M_{r,c}$表示第$c$对点在多少种情况下满足条件。将这个值记为$K$。

假设第$c$对点为$(P_a,P_b)$，要让这对点满足条件，只需对所有可能的$j$将$x_{1j},x_{2j},x_{3j},\dots,x_{nj}$进行排列，同时满足$x_{aj}<x_{bj}$。于是$K=(A_n^{n-2})^k$。

所以

$$E=\dfrac 1N A_n^2K=A_n^2\left(\dfrac{A_n^{n-2}}{A_n^n}\right)^k=\dfrac{A_n^2}{2^k}$$

---

## 题目3

已知$N$项有穷数列$\lbrace a_n\rbrace$满足：$0\leqslant a_1\leqslant 1$，且$n\geqslant 2$时有$P(a_n=p)=a_{n-1},P(a_n=q)=1-a_{n-1}$，其中$0<p,q<1$。试确定$a_1$的值，使$\sum\limits_{i=1}^Na_i$的期望$E$最大，并求出$E$的最大值。

设$a_n=p$时，$\sum\limits_{i=n}^Na_i$的期望为$S_n$；$a_n=q$时，$\sum\limits_{i=n}^Na_i$的期望为$T_n$。则$S_N=p,T_N=q$。

$a_n=p$时，有大小为$p$的概率$a_{n+1}=p$，此时$\sum\limits_{i=n+1}^Na_i$的期望$=S_{n+1}$；有大小为$1-p$的概率$a_{n+1}=q$，此时$\sum\limits_{i=n+1}^Na_i$的期望$=T_{n+1}$。于是得到

$$S_n=p+p\cdot S_{n+1}+(1-p)\cdot T_{n+1}\tag 1$$

同理得到

$$T_n=q+q\cdot S_{n+1}+(1-q)\cdot T_{n+1}\tag 2$$

特别地，

$$\begin{aligned}
E&=a_1+a_1\cdot S_2+(1-a_1)\cdot T_2\\
&=a_1(S_2-T_2+1)+T_2
\end{aligned}$$

$(1)$减$(2)$，得

$$S_n-T_n=(p-q)(S_{n+1}-T_{n+1})+(p-q)$$

记$\lambda=p-q\in(-1,0)$。可以发现$\left\lbrace S_n-T_n+\dfrac\lambda{\lambda-1}\right\rbrace$是等比数列，进而求出

$$S_n-T_n=\dfrac{\lambda^{N-n+2}-\lambda}{\lambda-1}\tag 3$$

于是$S_2-T_2+1=\dfrac{\lambda^N-1}{\lambda-1}>0$。所以$a_1=1$时$E$最大。

将$(3)$代入$(2)$，得

$$T_n=T_{n+1}+q\cdot\dfrac{\lambda^{N-n+1}-1}{\lambda-1}$$

可以发现$\left\lbrace T_n-q\cdot\dfrac{\lambda^{N-n+2}}{(\lambda-1)^2}\right\rbrace$是等差数列，进而求出

$$T_n=q\cdot\left[\dfrac{\lambda^{N-n+2}-\lambda^2}{(\lambda-1)^2}-\dfrac{N-n}{\lambda-1}+1\right]$$

所以

$$\begin{aligned}
E_{\max}&=(S_2-T_2)+T_2+1\\
&=\dfrac{\lambda^N-1}{\lambda-1}+q\cdot\left[\dfrac{\lambda^N-\lambda^2}{(\lambda-1)^2}-\dfrac{N-2}{\lambda-1}+1\right]\\
&=\dfrac{p-1}{(p-q-1)^2}\left[(p-q)^N-1\right]-\dfrac{Nq}{p-q-1}
\end{aligned}$$

---

## 题目4

### 题目4.1

将一个长为$a$、宽为$b$的矩形绕着一条过这个矩形的直线旋转一周，求得到的旋转体的体积的最大值。

显然这条直线必然经过矩形的一个顶点$A$。得到的旋转体可以看成两个圆台减去两个圆锥，圆锥和圆台的体积公式分别为

$$\begin{aligned}
V_{\text{锥}}&=\dfrac13\pi hr^2\\
V_{\text{台}}&=\dfrac13\pi h\left(r_1^2+r_2^2+r_1r_2\right)
\end{aligned}$$

设这条直线与长为$a$的边的夹角为$\theta$，则旋转体的体积为

$$\begin{aligned}
V&=\dfrac13\pi b\sin\theta\left[(a\sin\theta)^2+(a\sin\theta+b\cos\theta)^2+a\sin\theta(a\sin\theta+b\cos\theta)\right]
+\dfrac13\pi a\cos\theta\left[(b\cos\theta)^2+(a\sin\theta+b\cos\theta)^2+b\cos\theta(a\sin\theta+b\cos\theta)\right]
-\dfrac13\pi a\cos\theta(a\sin\theta)^2-\dfrac13\pi b\sin\theta(b\cos\theta)^2\\
&=\dfrac13\pi\left(3a^2b\sin^3\theta+3ab^2\sin^2\theta\cos\theta+3ab^2\cos^3\theta+3a^2b\sin\theta\cos^2\theta\right)\\
&=\pi ab(a\sin\theta+b\cos\theta)
\end{aligned}$$

令矩形的对角线长为$c=\sqrt{a^2+b^2}$，则

$$V=\pi abc\sin(\theta+\varphi)\leqslant\pi abc$$

其中$\varphi=\arctan\dfrac ba$。所以$\theta=\arctan\dfrac ab$时，$V$取得最大值$\pi abc$，此时该直线与矩形的过点$A$的对角线垂直。

### 题目4.2

假设地球是均匀球体，极点处的重力加速度为$g_0$，求纬度分别为$\theta_1,\theta_2$处的重力加速度$g_1,g_2$之间的关系。

设地球质量为$M$，半径为$R$，自转角速度为$\omega$。极点处的物体（质量为$m$）受到的万有引力即为其重力。

$$F_{\text{引}}=\dfrac{GMm}{R^2}=mg_0$$

纬度为$\theta$处的物体，其受到的万有引力可分解为重力$mg$和沿地球自转需要的向心力$F_{\text{向}}=m\omega^2R\cos\theta$，根据余弦定理得

$$\begin{aligned}
(mg)^2&=F_{\text{向}}^2+F_{\text{引}}^2-2F_{\text{向}}F_{\text{引}}\cos\theta\\
g^2&=g_0^2+\omega^4R^2\cos^2\theta-2g_0\omega^2R\cos^2\theta
\end{aligned}$$

令$\omega^2R=a$。对于赤道处的物体，有$F_{\text{引}}=F_{\text{向}}+mg_{\text{赤}}$，即$a=g_0-g_{\text{赤}}\leqslant g_0$。代入上式得

$$a^2\cos^2\theta-2g_0a\cos^2\theta+g_0^2-g^2=0$$

解得$a=g_0-\sqrt{g_0^2-\dfrac{g_0^2-g^2}{\cos^2\theta}}$。由于$a,g_0$是定值，所以$\dfrac{g_0^2-g^2}{\cos^2\theta}$是定值。于是

$$\dfrac{g_0^2-g_1^2}{\cos^2\theta_1}=\dfrac{g_0^2-g_2^2}{\cos^2\theta_2}$$

